<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Técnico | Panel</title>
  <link rel="stylesheet" href="/css/home_tecnico.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
</head>

<body>
  <!-- Navbar -->
  <nav class="admin-navbar">
    <div class="nav-container">
      <a href="/tecnico" class="nav-brand">
        <i class="bi bi-tools"></i>
        <span>Panel de Técnico</span>
      </a>
      <div class="nav-menu">
        <a href="/tecnico" class="nav-link active">Inicio</a>
        <a href="/tecnico/mios" class="nav-link">Mis Mantenimientos</a>
        <a href="/tecnico/mis-solicitudes" class="nav-link">Mis Solicitudes</a>
        <form th:action="@{/logout}" method="post" class="nav-form">
          <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
          <button type="submit" class="btn-logout">
            <i class="bi bi-box-arrow-right"></i>
            <span>Salir</span>
          </button>
        </form>
      </div>
    </div>
  </nav>

  <main class="main-container">
    <!-- Header -->
    <div class="page-header">
      <div class="header-content">
        <h1 class="page-title">Panel del Técnico</h1>
        <p class="page-subtitle">Bienvenido, <span th:text="${yo.nombre}">Técnico</span></p>
      </div>
      <div class="header-actions">
        <a href="/tecnico/mios" class="btn-primary">
          <i class="bi bi-list-check"></i>
          <span>Ver Mantenimientos</span>
        </a>
        <a href="/tecnico/crear-solicitud" class="btn-secondary">
          <i class="bi bi-plus-circle"></i>
          <span>Crear Solicitud</span>
        </a>
      </div>
    </div>

    <!-- Estadísticas -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon pending">
          <i class="bi bi-wrench-adjustable-circle"></i>
        </div>
        <div class="stat-info">
          <span class="stat-value" id="statPendientes" th:text="${pendientes != null ? pendientes : 0}">0</span>
          <span class="stat-label">Pendientes</span>
        </div>
        <div class="stat-glow"></div>
      </div>

      <div class="stat-card">
        <div class="stat-icon in-progress">
          <i class="bi bi-hourglass-split"></i>
        </div>
        <div class="stat-info">
          <span class="stat-value" id="statEnProceso" th:text="${enProceso != null ? enProceso : 0}">0</span>
          <span class="stat-label">En Proceso</span>
        </div>
        <div class="stat-glow"></div>
      </div>

      <div class="stat-card">
        <div class="stat-icon completed">
          <i class="bi bi-check2-circle"></i>
        </div>
        <div class="stat-info">
          <span class="stat-value" id="statCompletados" th:text="${completados != null ? completados : 0}">0</span>
          <span class="stat-label">Completados</span>
        </div>
        <div class="stat-glow"></div>
      </div>
    </div>

    <!-- Accesos Rápidos -->
    <div class="quick-access">
      <h2 class="section-title">Accesos Rápidos</h2>
      <div class="access-grid">
        <a href="/tecnico/mios" class="access-card">
          <div class="access-icon">
            <i class="bi bi-list-task"></i>
          </div>
          <div class="access-content">
            <h3>Mis Mantenimientos</h3>
            <p>Consulta y gestiona las órdenes que tienes asignadas</p>
          </div>
          <div class="access-arrow">
            <i class="bi bi-arrow-right"></i>
          </div>
          <div class="card-hover-effect"></div>
        </a>

        <a href="/tecnico/crear-solicitud" class="access-card">
          <div class="access-icon">
            <i class="bi bi-box-seam"></i>
          </div>
          <div class="access-content">
            <h3>Crear Solicitud</h3>
            <p>Genera una nueva solicitud de repuestos</p>
          </div>
          <div class="access-arrow">
            <i class="bi bi-arrow-right"></i>
          </div>
          <div class="card-hover-effect"></div>
        </a>

        <a href="/tecnico/mis-solicitudes" class="access-card">
          <div class="access-icon">
            <i class="bi bi-clock-history"></i>
          </div>
          <div class="access-content">
            <h3>Mis Solicitudes</h3>
            <p>Revisa el estado de tus solicitudes de repuestos</p>
          </div>
          <div class="access-arrow">
            <i class="bi bi-arrow-right"></i>
          </div>
          <div class="card-hover-effect"></div>
        </a>
      </div>
    </div>

    <!-- Mantenimientos Recientes -->
    <div class="recent-section">
      <div class="section-header">
        <h2 class="section-title">Mantenimientos Recientes</h2>
        <a href="/tecnico/mios" class="view-all">
          <span>Ver Todos</span>
          <i class="bi bi-arrow-right"></i>
        </a>
      </div>

      <div class="recent-list" id="recentList">
        <div th:if="${recientes != null and !recientes.empty}" class="recent-items-container">
          <div th:each="mtto : ${recientes}" class="recent-item">
            <div class="recent-info">
              <h4 th:text="'MT-' + ${mtto.id} + ' - ' + ${mtto.maquina?.codigo}">MT-001 - Prensa Hidráulica</h4>
              <p th:text="'Programado: ' + ${mtto.programadoPara}">Programado: 2025-01-15</p>
              <p th:text="'Tipo: ' + ${mtto.tipo}">Tipo: PREVENTIVO</p>
            </div>
            <span th:classappend="'recent-status status-' + ${mtto.estado.name().toLowerCase()}"
              th:text="${mtto.estado.name()}" class="recent-status">
              PENDIENTE
            </span>
          </div>
        </div>
        <div th:if="${recientes == null or recientes.empty}" class="empty-state">
          <i class="bi bi-inbox"></i>
          <p>No hay mantenimientos recientes</p>
          <a href="/tecnico/mios" class="btn-primary" style="margin-top: 1rem;">
            <i class="bi bi-eye"></i>
            <span>Ver Todos los Mantenimientos</span>
          </a>
        </div>
      </div>
    </div>
  </main>

  <script src="/js/home_tecnico.js"></script>
</body>

</html>