<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Solicitar Repuesto | Técnico</title>
  <link rel="stylesheet" href="/css/solicitud_repuestos.css">
</head>

<body>
  <!-- Navbar -->
  <nav class="admin-navbar">
    <div class="nav-container">
      <a th:href="@{/tecnico}" class="nav-brand">
        <i class="bi bi-tools"></i>
        <span>Panel de Técnico</span>
      </a>
      <div class="nav-menu">
        <a th:href="@{/tecnico}" class="nav-link">Inicio</a>
        <a th:href="@{/tecnico/mios}" class="nav-link">Mis Mantenimientos</a>
        <a th:href="@{/tecnico/mis-solicitudes}" class="nav-link">Mis Solicitudes</a>
        <form th:action="@{/logout}" method="post" class="nav-form">
          <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
          <button type="submit" class="btn-logout">
            <i class="bi bi-box-arrow-right"></i>
            <span>Salir</span>
          </button>
        </form>
      </div>
    </div>
  </nav>

  <main class="main-container">
    <!-- Header -->
    <div class="page-header">
      <div class="header-content">
        <h1 class="page-title">Solicitar Repuesto</h1>
        <p class="page-subtitle">Completa los datos para solicitar un repuesto</p>
      </div>
      <a th:href="@{/tecnico/crear-solicitud}" class="btn-back">
        <i class="bi bi-arrow-left"></i>
        <span>Volver a Selección</span>
      </a>
    </div>

    <!-- Información del Mantenimiento -->
    <div class="card info-card">
      <div class="card-header">
        <i class="bi bi-info-circle"></i>
        <h2>Información del Mantenimiento</h2>
      </div>
      <div class="card-body">
        <div class="info-grid">
          <div class="info-item">
            <label class="info-label">Máquina:</label>
            <span class="info-value" th:text="${mtto?.maquina?.nombre} ?: '—'">—</span>
          </div>
          <div class="info-item">
            <label class="info-label">Código:</label>
            <span class="info-value" th:text="${mtto?.maquina?.codigo} ?: '—'">—</span>
          </div>
          <div class="info-item">
            <label class="info-label">Tipo de Mantenimiento:</label>
            <span class="info-value" th:text="${mtto?.tipo} ?: '—'">—</span>
          </div>
          <div class="info-item">
            <label class="info-label">Estado:</label>
            <span class="status-badge" th:text="${mtto?.estado} ?: '—'">—</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Formulario de Solicitud -->
    <div class="card form-card">
      <div class="card-header">
        <i class="bi bi-box-seam"></i>
        <h2>Datos del Repuesto</h2>
      </div>
      <div class="card-body">
        <form th:action="@{/tecnico/repuestos/solicitar}" method="post" class="solicitud-form" id="solicitudForm">
          <input type="hidden" name="mttoId" th:value="${mtto?.id}">
          <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">

          <!-- Campo MOTIVO (requerido) -->
          <div class="form-group">
            <label class="form-label" for="motivo">Motivo de la Solicitud</label>
            <select class="form-select" name="motivo" id="motivo" required>
              <option value="">Selecciona un motivo</option>
              <option value="Falla técnica">Falla técnica</option>
              <option value="Desgaste normal">Desgaste normal</option>
              <option value="Repuesto dañado">Repuesto dañado</option>
              <option value="Repuesto faltante">Repuesto faltante</option>
              <option value="Mantenimiento preventivo">Mantenimiento preventivo</option>
              <option value="Mejora o actualización">Mejora o actualización</option>
              <option value="Otro">Otro</option>
            </select>
            <div class="form-hint">Selecciona el motivo principal de la solicitud</div>
          </div>

          <!-- Campo CÓDIGO MÁQUINA (requerido) -->
          <div class="form-group">
            <label class="form-label" for="codigoMaquina">Código de Máquina</label>
            <input type="text" class="form-input" name="codigoMaquina" id="codigoMaquina"
              th:value="${mtto?.maquina?.codigo}" readonly placeholder="Código de la máquina" required>
            <div class="form-hint">Código identificador de la máquina</div>
          </div>

          <div class="form-group">
            <label class="form-label">Descripción Detallada del Repuesto</label>
            <textarea class="form-textarea" name="descripcion" rows="6" placeholder="Describe detalladamente el repuesto necesario, incluyendo:
• Nombre específico del repuesto
• Cantidad requerida
• Especificaciones técnicas
• Falla detectada que justifica la solicitud
• Urgencia de la solicitud" required></textarea>
            <div class="form-hint">Sé lo más específico posible para agilizar el proceso</div>
          </div>

          <div class="form-actions">
            <button type="button" class="btn-secondary" onclick="window.history.back()">
              <i class="bi bi-x-circle"></i>
              <span>Cancelar</span>
            </button>
            <button type="submit" class="btn-primary">
              <i class="bi bi-send"></i>
              <span>Enviar Solicitud</span>
            </button>
          </div>
        </form>
      </div>
    </div>
  </main>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  <script src="/js/solicitud_repuestos.js"></script>
</body>

</html>