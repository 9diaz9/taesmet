<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Iniciar sesión | Taesmet</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    :root{ --bg:#0b1220; --panel:#0f172a; --muted:#94a3b8; --accent:#0ea5e9; --warn:#f59e0b; }
    html,body{height:100%}
    body{
      background: radial-gradient(1200px 600px at 80% -100px, #12213f 0%, transparent 60%) no-repeat,
                  radial-gradient(900px 500px at -10% 120%, #13233f 0%, transparent 55%) no-repeat,
                  var(--bg);
      color:#e5e7eb; display:flex; align-items:center; justify-content:center; padding:32px;
    }
    .login-card{
      width:100%; max-width:420px;
      background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01)), var(--panel);
      border:1px solid rgba(255,255,255,.06); border-radius:18px; box-shadow:0 20px 60px rgba(0,0,0,.45);
      overflow:hidden;
    }
    .login-head{ padding:22px 22px 8px; border-bottom:1px solid rgba(255,255,255,.06); }
    .brand{ display:flex; align-items:center; gap:.6rem; font-weight:800; letter-spacing:.2px; }
    .brand i{ color:var(--warn) }
    .sub{ color:var(--muted); font-size:.92rem; }
    .login-body{ padding:22px; }
    .form-control,.form-check-input{ background:#0b1324; border-color:#1f2a44; color:#e5e7eb; }
    .form-control:focus{ background:#0b1324; border-color:var(--accent); box-shadow:0 0 0 .2rem rgba(14,165,233,.15); }
    .btn-primary{ background:var(--accent); border-color:var(--accent); }
    .btn-primary:hover{ filter:brightness(1.05); }
    .footer-links{ color:var(--muted); font-size:.9rem; }
    .footer-links a{ color:#cbd5e1; text-decoration:none; }
    .footer-links a:hover{ color:#fff; text-decoration:underline; }
    .alert{ border-radius:12px; }
  </style>
</head>
<body>

  <div class="login-card">
    <div class="login-head">
      <div class="brand">
        <i class="bi bi-shield-lock-fill fs-4"></i>
        <div>
          <div>Taesmet • Acceso</div>
          <div class="sub">Ingresa con tu correo corporativo</div>
        </div>
      </div>
    </div>

    <div class="login-body">
      <!-- Mensajes de estado -->
      <div th:if="${param.error}" class="alert alert-danger d-flex align-items-center py-2 px-3" role="alert">
        <i class="bi bi-x-circle me-2"></i>
        <div>Credenciales inválidas o usuario inactivo.</div>
      </div>
      <div th:if="${param.logout}" class="alert alert-success d-flex align-items-center py-2 px-3" role="alert">
        <i class="bi bi-check-circle me-2"></i>
        <div>Sesión cerrada correctamente.</div>
      </div>

      <!-- Formulario -->
      <form th:action="@{/login}" method="post" class="needs-validation" novalidate>
        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>

        <div class="mb-3">
          <label class="form-label">Correo</label>
          <!-- Tu app espera name="email" -->
          <div class="input-group">
            <span class="input-group-text bg-transparent text-secondary border-0 ps-0">
              <i class="bi bi-envelope"></i>
            </span>
            <input
              class="form-control"
              type="email"
              name="email"
              placeholder="usuario@taesmet.com"
              required
              pattern="(?=.{5,64}$)[A-Za-z0-9._%+-]+@taesmet\.com"
              title="Usa tu correo corporativo @taesmet.com">
          </div>
          <div class="invalid-feedback">Ingresa un correo @taesmet.com válido.</div>
        </div>

        <div class="mb-2">
          <label class="form-label">Contraseña</label>
          <div class="input-group">
            <span class="input-group-text bg-transparent text-secondary border-0 ps-0">
              <i class="bi bi-lock"></i>
            </span>
            <input class="form-control" type="password" name="password" id="pwd" placeholder="••••••••" required minlength="8">
            <button class="btn btn-outline-secondary" type="button" id="togglePwd" title="Mostrar/Ocultar">
              <i class="bi bi-eye"></i>
            </button>
          </div>
          <div class="form-text text-muted">
            Ejemplos válidos: <code>Peru2024#</code>, <code>Nicolas#12</code>, <code>52242002bB#</code>
          </div>
        </div>

        <div class="d-flex justify-content-between align-items-center mb-3">
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="remember" name="remember-me">
            <label class="form-check-label" for="remember">Recordarme</label>
          </div>
          <a href="#" class="link-light-50 text-decoration-none" style="color:#cbd5e1">¿Olvidaste tu contraseña?</a>
        </div>

        <button class="btn btn-primary w-100 py-2">
          <i class="bi bi-box-arrow-in-right me-1"></i> Iniciar sesión
        </button>
      </form>

      <div class="footer-links mt-4 text-center">
        ¿No tienes acceso? Contacta a <a href="mailto:admin@taesmet.com">admin@taesmet.com</a>
      </div>
    </div>
  </div>

  <script>
    // Mostrar/ocultar contraseña
    const btn = document.getElementById('togglePwd');
    const pwd = document.getElementById('pwd');
    btn?.addEventListener('click', () => {
      const showing = pwd.type === 'text';
      pwd.type = showing ? 'password' : 'text';
      btn.innerHTML = `<i class="bi ${showing ? 'bi-eye' : 'bi-eye-slash'}"></i>`;
    });

    // Validación Bootstrap
    (function () {
      'use strict';
      const forms = document.querySelectorAll('.needs-validation');
      Array.prototype.slice.call(forms).forEach(function (form) {
        form.addEventListener('submit', function (event) {
          if (!form.checkValidity()) { event.preventDefault(); event.stopPropagation(); }
          form.classList.add('was-validated');
        }, false);
      });
    })();
  </script>
</body>
</html>
